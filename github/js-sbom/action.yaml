name: Java SBOM Build
description: Builds an SBOM for a Java project
inputs:
  path:
    required: true
    description: The path to the project
  output_path:
    required: true
    description: The output path for the SBOM file

runs:
  using: "composite"
  steps:
    - name: Install CycloneDX
      run: npm install --global @cyclonedx/cyclonedx-npm
      shell: bash

    - name: Generate SBOM
      run: |
        pushd ${{ inputs.path }}
        yarn install
        cyclonedx-npm --ignore-npm-errors --output-file bom.json
        popd
        mkdir -p ${{ inputs.output_path }}
        mv ${{ inputs.path }}/bom.json ${{ inputs.output_path }}/bom.json
      shell: bash